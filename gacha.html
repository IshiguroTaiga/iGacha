<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gacha Calculator</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        * {
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background-image: url('https://i.pinimg.com/736x/2f/52/e2/2f52e2b27eca32272392e8dfb7dab6c0.jpg');
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
            background-color: rgba(101, 73, 161, 0.4);
            background-blend-mode: multiply;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            color: #fff;
        }
        
        h1 { 
            text-align: center;
            color: #fff;
            text-shadow: 0 2px 10px rgba(101, 73, 161, 0.7);
            margin-bottom: 30px;
            font-weight: 600;
            letter-spacing: 1px;
        }
        
        .calculator {
            background-color: rgba(70, 50, 120, 0.85);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            max-width: 600px;
            margin: 0 auto;
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255,255,255,0.15);
        }
        
        .section {
            margin-bottom: 25px;
            padding: 20px;
            border-radius: 12px;
            background-color: rgba(255,255,255,0.15);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .section:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            transform: translateY(-3px);
            background-color: rgba(255,255,255,0.2);
        }
        
        .section-title {
            margin-top: 0;
            color: #d7b8ff;
            font-weight: 600;
            margin-bottom: 15px;
            font-size: 1.2rem;
            border-bottom: 2px solid #9c6ade;
            padding-bottom: 8px;
        }
        
        select, input {
            padding: 12px 15px;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            font-size: 16px;
            margin: 8px 0;
            width: 100%;
            background-color: rgba(40, 20, 80, 0.6);
            color: #fff;
            transition: all 0.3s;
        }
        
        select:focus, input:focus {
            outline: none;
            border-color: #b388ff;
            box-shadow: 0 0 0 3px rgba(179, 136, 255, 0.3);
            background-color: rgba(40, 20, 80, 0.8);
        }
        
        option {
            background-color: #3a2465;
        }
        
        button {
            background: linear-gradient(135deg, #7e57c2, #4527a0);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: block;
            width: 100%;
            padding: 15px;
            margin-top: 25px;
            border-radius: 8px;
            font-size: 1.1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
            background: linear-gradient(135deg, #9575cd, #5e35b1);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .radio-group {
            margin: 15px 0;
        }
        
        .radio-option {
            margin: 10px 0;
            display: flex;
            align-items: center;
        }
        
        .radio-option input {
            width: auto;
            margin-right: 10px;
            accent-color: #b388ff;
        }
        
        .radio-option label {
            font-size: 1rem;
            color: #e6d6ff;
        }
        
        .results {
            margin-top: 25px;
            padding: 20px;
            background: linear-gradient(135deg, rgba(123, 77, 197, 0.3), rgba(81, 45, 168, 0.3));
            border-radius: 12px;
            display: none;
            animation: fadeIn 0.5s ease;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .result-item {
            margin: 15px 0;
            font-size: 1.1rem;
            display: flex;
            justify-content: space-between;
            color: #e6d6ff;
        }
        
        .highlight {
            font-weight: bold;
            color: #ff9e80;
            font-size: 1.2rem;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #d7b8ff;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Responsive adjustments */
        @media (max-width: 600px) {
            .calculator {
                padding: 15px;
            }
            
            .section {
                padding: 15px;
            }
            
            h1 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <h1>Gacha Calculator</h1>
    <div class="calculator">
        <div class="section">
            <h2 class="section-title">Game Selection</h2>
            <select id="game-select">
                <option value="">-- Select a Game --</option>
                <option value="pgr">Punishing: Gray Raven (PGR)</option>
                <option value="wuwa">Wuthering Waves (WuWa)</option>
                <option value="hsr">Honkai: Star Rail (HSR)</option>
            </select>
        </div>

        <div class="section" id="target-section" style="display: none;">
            <h2 class="section-title">Target</h2>
            <div class="radio-group">
                <div class="radio-option">
                    <input type="radio" id="target-character" name="target" value="character" checked>
                    <label for="target-character">Character</label>
                </div>
                <div class="radio-option">
                    <input type="radio" id="target-weapon" name="target" value="weapon">
                    <label for="target-weapon">Weapon</label>
                </div>
            </div>
        </div>

        <div class="section" id="status-section" style="display: none;">
            <h2 class="section-title">Current Status</h2>
            <div>
                <label for="current-pulls">Current Pulls:</label>
                <input type="number" id="current-pulls" min="0" value="0">
            </div>
            <div>
                <label for="current-currency">Current Currency:</label>
                <input type="number" id="current-currency" min="0" value="0">
            </div>
        </div>

        <div class="section" id="rateup-section" style="display: none;">
            <h2 class="section-title" id="rateup-title">Rate-up Status</h2>
            <div class="radio-group" id="rateup-options">
                <!-- Options will be populated by JavaScript -->
            </div>
        </div>

        <button id="calculate-btn" style="display: none;">Calculate</button>

        <div class="results" id="results">
            <h2 class="section-title">Results</h2>
            <div class="result-item">
                <span>Pulls needed:</span> <span id="pulls-needed" class="highlight">0</span>
                <span id="pulls-note"></span>
            </div>
            <div class="result-item">
                <span>Currency needed:</span> <span id="currency-needed" class="highlight">0</span>
            </div>
            <div class="result-item">
                <span>Worst case scenario:</span> <span id="worst-case" class="highlight">N/A</span>
            </div>
        </div>
    </div>

    <script>
        // Game data
        const games = {
            pgr: {
                name: "Punishing: Gray Raven (PGR)",
                character: {
                    pity: 60,
                    cost: 27500,
                    hasRateUp: false
                },
                weapon: {
                    pity: 50,
                    cost: 27500,
                    hasRateUp: true,
                    rateUpType: "80/20",
                    guaranteedPity: 50
                }
            },
            wuwa: {
                name: "Wuthering Waves (WuWa)",
                character: {
                    pity: 80,
                    cost: 38400,
                    hasRateUp: true,
                    rateUpType: "50/50",
                    guaranteedPity: 160
                },
                weapon: {
                    pity: 80,
                    cost: 38400,
                    hasRateUp: false
                }
            },
            hsr: {
                name: "Honkai: Star Rail (HSR)",
                character: {
                    pity: 90,
                    cost: 54400,
                    hasRateUp: true,
                    rateUpType: "50/50",
                    guaranteedPity: 180
                },
                weapon: {
                    pity: 80,
                    cost: 54400,
                    hasRateUp: true,
                    rateUpType: "75/25",
                    guaranteedPity: 160
                }
            }
        };

        // DOM elements
        const gameSelect = document.getElementById("game-select");
        const targetSection = document.getElementById("target-section");
        const statusSection = document.getElementById("status-section");
        const rateupSection = document.getElementById("rateup-section");
        const rateupTitle = document.getElementById("rateup-title");
        const rateupOptions = document.getElementById("rateup-options");
        const calculateBtn = document.getElementById("calculate-btn");
        const resultsDiv = document.getElementById("results");
        const pullsNeeded = document.getElementById("pulls-needed");
        const pullsNote = document.getElementById("pulls-note");
        const currencyNeeded = document.getElementById("currency-needed");
        const worstCase = document.getElementById("worst-case");

        // Event listeners
        gameSelect.addEventListener("change", updateTargetSection);
        document.querySelectorAll('input[name="target"]').forEach(radio => {
            radio.addEventListener("change", updateRateUpSection);
        });
        calculateBtn.addEventListener("click", calculate);

        function updateTargetSection() {
            const game = gameSelect.value;
            if (game) {
                targetSection.style.display = "block";
                statusSection.style.display = "block";
                calculateBtn.style.display = "block";
                updateRateUpSection();
            } else {
                targetSection.style.display = "none";
                statusSection.style.display = "none";
                rateupSection.style.display = "none";
                calculateBtn.style.display = "none";
                resultsDiv.style.display = "none";
            }
        }

        function updateRateUpSection() {
            const game = gameSelect.value;
            const target = document.querySelector('input[name="target"]:checked').value;
            
            if (!game) return;
            
            const gameData = games[game][target];
            
            // Clear previous options
            rateupOptions.innerHTML = "";
            
            if (gameData.hasRateUp) {
                rateupSection.style.display = "block";
                rateupTitle.textContent = `${gameData.rateUpType} Status`;
                
                const rateUpType = gameData.rateUpType;
                
                // Create radio options
                const yesOption = document.createElement("div");
                yesOption.className = "radio-option";
                yesOption.innerHTML = `
                    <input type="radio" id="rateup-yes" name="rateup" value="yes" checked>
                    <label for="rateup-yes">Yes - Won ${rateUpType}</label>
                `;
                
                const noOption = document.createElement("div");
                noOption.className = "radio-option";
                noOption.innerHTML = `
                    <input type="radio" id="rateup-no" name="rateup" value="no">
                    <label for="rateup-no">No - Not guaranteed</label>
                `;
                
                rateupOptions.appendChild(yesOption);
                rateupOptions.appendChild(noOption);
            } else {
                rateupSection.style.display = "none";
            }
        }

        function calculate() {
            const game = gameSelect.value;
            const target = document.querySelector('input[name="target"]:checked').value;
            const currentPulls = parseInt(document.getElementById("current-pulls").value) || 0;
            const currentCurrency = parseInt(document.getElementById("current-currency").value) || 0;
            
            const gameData = games[game][target];
            let rateupWon = false;
            
            if (gameData.hasRateUp) {
                rateupWon = document.querySelector('input[name="rateup"]:checked').value === "yes";
            }
            
            // Calculate pulls needed
            let pullsNeededValue, scenarioNote, worstCaseValue;
            
            if (gameData.hasRateUp && !rateupWon) {
                pullsNeededValue = Math.max(0, gameData.guaranteedPity - currentPulls);
                scenarioNote = ` (guaranteed - lost previous ${gameData.rateUpType})`;
                
                // Calculate worst case
                const costPerPull = gameData.cost / gameData.pity;
                const worstCasePulls = Math.max(0, gameData.guaranteedPity - currentPulls);
                const worstCaseCurrency = Math.max(0, (worstCasePulls * costPerPull) - currentCurrency);
                worstCaseValue = `${worstCasePulls} pulls, ${Math.round(worstCaseCurrency)} currency`;
            } else {
                pullsNeededValue = Math.max(0, gameData.pity - currentPulls);
                scenarioNote = gameData.hasRateUp ? ` (won previous ${gameData.rateUpType})` : "";
                worstCaseValue = "N/A";
            }
            
            // Calculate currency needed
            const costPerPull = gameData.cost / gameData.pity;
            const currencyNeededValue = Math.max(0, (pullsNeededValue * costPerPull) - currentCurrency);
            
            // Display results
            pullsNeeded.textContent = pullsNeededValue;
            pullsNote.textContent = scenarioNote;
            currencyNeeded.textContent = Math.round(currencyNeededValue);
            worstCase.textContent = worstCaseValue;
            
            resultsDiv.style.display = "block";
        }
    </script>
</body>
</html>